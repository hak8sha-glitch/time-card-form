<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>タイムカード</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
  <h2>接続チェック中...</h2>
  <div id="msg">しばらくお待ちください</div>

  <script>
    // 153.203.110.246
    const allowedIPs = ["153.203.110.246"];

    // https://docs.google.com/forms/d/1CCNwzw08AKt5twRVSDU9owVZzyYCEZ6OtBjXTJezSPs/edit
    const formEmbedUrl = "https://docs.google.com/forms/d/e/https://docs.google.com/forms/d/1CCNwzw08AKt5twRVSDU9owVZzyYCEZ6OtBjXTJezSPs/edit/viewform?embedded=true";

    async function checkIP() {
      const r = await fetch("https://api.ipify.org?format=json");
      const data = await r.json();
      const myIP = data.ip;
      const msg = document.getElementById("msg");

      if (allowedIPs.includes(myIP)) {
        msg.innerHTML = `<p style='color:green;'>会社Wi-Fi確認（IP:${myIP}）✅</p><iframe src="${formEmbedUrl}" width="100%" height="800"></iframe>`;
      } else {
        msg.innerHTML = `<p style='color:red;'>このネットワーク（IP:${myIP}）では使えません。会社のWi-Fiにつないでください。</p>`;
      }
    }

    checkIP();
  </script>
</body>
</html>
